"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createLibraryFiles = void 0;
const devkit_1 = require("@nx/devkit");
const js_1 = require("@nx/js");
const create_ts_config_1 = require("../../../utils/create-ts-config");
function createLibraryFiles(host, options) {
    const relativePathToRootTsConfig = (0, js_1.getRelativePathToRootTsConfig)(host, options.projectRoot);
    const substitutions = {
        ...options,
        ...(0, devkit_1.names)(options.name),
        tmpl: '',
        offsetFromRoot: (0, devkit_1.offsetFromRoot)(options.projectRoot),
        fileName: options.fileName,
    };
    (0, devkit_1.generateFiles)(host, (0, devkit_1.joinPathFragments)(__dirname, '../files'), options.projectRoot, substitutions);
    if (!options.publishable && options.bundler === 'none') {
        host.delete(`${options.projectRoot}/package.json`);
    }
    if (options.unitTestRunner !== 'vitest') {
        host.delete(`${options.projectRoot}/tsconfig.spec.json`);
    }
    if (options.js) {
        (0, devkit_1.toJS)(host);
    }
    (0, create_ts_config_1.createTsConfig)(host, options.projectRoot, 'lib', options, relativePathToRootTsConfig);
}
exports.createLibraryFiles = createLibraryFiles;
